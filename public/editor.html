<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Editor</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/style.css" rel="stylesheet">
    <!-- <link href="css/lt-style.css" rel="stylesheet"> -->

    <script src="js/Chart.js"></script>
    <script src="js/EasyChart.js"></script>

    <script type="text/javascript"
    src="https://www.languagetool.org/js/jquery-1.7.0.min.js"></script>
    <script type="text/javascript"
        src="https://www.languagetool.org/online-check/tiny_mce/tiny_mce.js"></script>
    <script type="text/javascript"
        src="https://www.languagetool.org/online-check/tiny_mce/plugins/atd-tinymce/editor_plugin2.js"></script>

    <script language="javascript" type="text/javascript">
      tinyMCE.init({
         mode : "textareas",
         theme : "advanced",
         force_br_newlines : false,
         force_p_newlines : false,
         forced_root_block : '',
         plugins : "AtD,paste",
         paste_text_sticky : true,
         setup : function(ed) {
             ed.onInit.add(function(ed) {
                 ed.pasteAsPlainText = true;
             });
         },
         /* translations: */
         languagetool_i18n_no_errors : {
             // "No errors were found.":
             "de-DE": "Keine Fehler gefunden."
         },
         languagetool_i18n_explain : {
             // "Explain..." - shown if there is an URL with a detailed description:
             "de-DE": "Mehr Informationen..."
         },
         languagetool_i18n_ignore_once : {
             // "Ignore this error":
             "de-DE": "Hier ignorieren"
         },
         languagetool_i18n_ignore_all : {
             // "Ignore this kind of error":
             "de-DE": "Fehler dieses Typs ignorieren"
         },
         languagetool_i18n_rule_implementation : {
             // "Rule implementation":
             "de-DE": "Implementierung der Regel"
         },

         languagetool_i18n_current_lang :
             function() { return document.checkform.lang.value; },
         /* The URL of your LanguageTool server.
            If you use your own server here and it's not running on the same domain
            as the text form, make sure the server gets started with '--allow-origin ...'
            and use 'https://your-server/v2/check' as URL: */
         languagetool_rpc_url                 : "https://languagetool.org/api/v2/check",
         /* edit this file to customize how LanguageTool shows errors: */
         languagetool_css_url :
             "https://www.languagetool.org/online-check/" +
             "tiny_mce/plugins/atd-tinymce/css/content.css",
         /* this stuff is a matter of preference: */
         theme                              : "advanced",
         theme_advanced_buttons1            : "",
         theme_advanced_buttons2            : "",
         theme_advanced_buttons3            : "",
         theme_advanced_toolbar_location    : "none",
         theme_advanced_toolbar_align       : "left",
         theme_advanced_statusbar_location  : "bottom",
         theme_advanced_path                : false,
         theme_advanced_resizing            : true,
         theme_advanced_resizing_use_cookie : false,
         gecko_spellcheck                   : false
      });

      function doit() {
         var langCode = document.checkform.lang.value;
         tinyMCE.activeEditor.execCommand("mceWritingImprovementTool", langCode);
      }
    </script>

</head>

<body>
    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="../index.html">Home</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="#">About</a>
                    </li>
                    <li>
                        <a href="#">Services</a>
                    </li>
                    <li>
                        <a href="#">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Content -->
    <div class="container">

        <!-- Jumbotron Header -->
        <header class="jumbotron hero-spacer" id="instructions">
            <p><b>Write a sentence about your week.</b></p>
            <!-- <p><a class="btn btn-primary btn-large">Call to action!</a> -->
            <!-- </p> -->
        </header>

        <hr id ="sep">

        <!-- Main page content -->
        <div class="analytics" style="display:none">
            <!-- <div class="chart"> -->
                <div id="barChartDiv">
                    <canvas id="barChart"></canvas>
                </div>
                <div id="radarDiv">
                    <canvas id="radar"></canvas>
                </div>
            <!-- </div> -->
        </div>

        <div class="outer-textbox">
            <!-- LANGUAGETOOL TEXTBOX -->
            <form name="checkform" action="http://community.languagetool.org" method="post">
              <p id="checktextpara">
                  <textarea id="checktext" name="text" style="width: 100%" rows="6">
                    "The Necklace", by Gue de Maupassant, is a story about a woman named Ms. Loisel. she was petty and charming. She married a common little clark. Her life was in poverty and depression. One day, She and her husband received an invitation to attend a ball. To conceal her impoverished family situations and show off her charm and beauty, she borrowed a necklace from her friend. Then, at the ball she did have a wonderful time. However, she lost the necklace after the ball. The poor woman and her husband had to spend up all their saving and borrowed a lot money to buy a real diamond necklace for returning. In the following ten years, this couple suffered more hard works and more stingy life to pay off the debt. At last, M.s Loisel ran into her friend again and knew that the necklace she borrowed was paste in stead of diamond.
                </textarea>
              </p>
              <div id="uglyButton">
                  <select name="lang" id="lang">
                      <option value="en-US">English</option>
                      <option value="de-DE">German</option>
                      <option value="it">Italian</option>
                  </select>

                  <input type="submit" name="_action_checkText"
                      value="Check Text" onClick="doit();return false;">
                  <div id="feedbackErrorMessage" style="color: red;"></div>
              </div>
            </form>
            <!-- END LANGUAGETOOL TEXTBOX -->
        </div>
        <button type="submit" class="btn btn-primary btn-lg" id="analyze-button">Submit for Evaluation</button>

        <hr>

        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="col-lg-12">
                    <p>Copyright &copy; ohNODEyoudidnt 2017</p>
                </div>
            </div>
        </footer>

    </div>
    <!-- /.container -->

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>
    <script src="https://cdn.quilljs.com/1.2.0/quill.js"></script>

    <!-- Initialize Quill editor -->
    <script>

    $('#analyze-button').click(function() {
          doit();
          let userText = tinymce.get('checktext').getContent();

          $('.analytics').css(
              {
                //   'height': '600px',
                  'width': '100%',
                  'margin-bottom': '20px',
                  'display': 'block'
              }
          );

          $('#instructions').css(
              {
                  'display': 'none'
              }
          );

          $('#sep').css(
              {
                  'display': 'none'
              }
          );

          $.ajax({
              type: "POST",
              url: "/analyze",
              data: {
                  toAnalyze: userText
              },
              success: function(msg) {
                //   $('.chart').css (
                    //   {
                        //   'margin': '0 auto'
                    //   }
                //   )
                  $('#barChartDiv').css (
                      {
                          'display': 'inline-block',
                          'height': '500px',
                          'width': '48%',
                      }
                  )
                  $('#radarDiv').css (
                      {
                          'display': 'inline-block',
                          'height': '400px',
                          'width': '48%',
                          'margin-bottom': '100px'
                      }
                  )
                  plot("bar",
                      ["Letters per Sentence", "Words per Sentence", "Letters per Word", "Syllables per Word"],
                      [65, 59, 90, 81],
                      [28, 48, 40, 19],
                      "barChart"
                  );
                  plot("radar",
                      ["Letters per Sentence", "Words per Sentence", "Letters per Word", "Syllables per Word", "asf"],
                      [65, 59, 90, 81, 45],
                      [28, 48, 40, 19, 51],
                      "radar"
                  );
                  console.log(msg);
              }
          });
      })
    </script>

</body>
</html>
